{"ast":null,"code":"import loginService from '../../services/login';\nimport { createSlice } from '@reduxjs/toolkit';\nimport blogService from '../../services/blogs';\nconst authSlice = createSlice({\n  name: 'auth',\n  initialState: {\n    user: null,\n    error: null\n  },\n  reducers: {\n    loginSuccess: (state, action) => {\n      state.user = action.payload;\n      state.error = null;\n    },\n    loginFailure: (state, action) => {\n      state.user = null;\n      state.error = action.payload;\n    },\n    logout: state => {\n      state.user = null;\n      state.error = null;\n    }\n  }\n});\nexport const initializeUser = () => {\n  const loggedUserJson = window.localStorage.getItem('loggedBlogappUser');\n\n  if (loggedUserJson) {\n    const user = JSON.parse(loggedUserJson);\n    loginService.setToken(user.token);\n    return authSlice.actions.loginSuccess(user);\n  }\n\n  return loginFailure();\n};\nexport const login = (username, password) => async dispatch => {\n  try {\n    const user = await loginService.login({\n      username,\n      password\n    });\n    window.localStorage.setItem('loggedBlogappUser', JSON.stringify(user));\n    blogService.setToken(user.token);\n    dispatch(authSlice.actions.loginSuccess(user));\n  } catch (exception) {\n    dispatch(authSlice.actions.loginFailure(exception));\n  }\n};\nexport const {\n  loginSuccess,\n  loginFailure\n} = authSlice.actions;\nexport default authSlice.reducer;","map":{"version":3,"sources":["/home/ali/Vscodecop/FullstackOpen/blogs/client/src/features/users/authSlice.js"],"names":["loginService","createSlice","blogService","authSlice","name","initialState","user","error","reducers","loginSuccess","state","action","payload","loginFailure","logout","initializeUser","loggedUserJson","window","localStorage","getItem","JSON","parse","setToken","token","actions","login","username","password","dispatch","setItem","stringify","exception","reducer"],"mappings":"AAAA,OAAOA,YAAP,MAAyB,sBAAzB;AACA,SAASC,WAAT,QAA4B,kBAA5B;AACA,OAAOC,WAAP,MAAwB,sBAAxB;AAEA,MAAMC,SAAS,GAAGF,WAAW,CAAC;AAC5BG,EAAAA,IAAI,EAAE,MADsB;AAE5BC,EAAAA,YAAY,EAAE;AACZC,IAAAA,IAAI,EAAE,IADM;AAEZC,IAAAA,KAAK,EAAE;AAFK,GAFc;AAM5BC,EAAAA,QAAQ,EAAE;AACRC,IAAAA,YAAY,EAAE,CAACC,KAAD,EAAQC,MAAR,KAAmB;AAC/BD,MAAAA,KAAK,CAACJ,IAAN,GAAaK,MAAM,CAACC,OAApB;AACAF,MAAAA,KAAK,CAACH,KAAN,GAAc,IAAd;AACD,KAJO;AAKRM,IAAAA,YAAY,EAAE,CAACH,KAAD,EAAQC,MAAR,KAAmB;AAC/BD,MAAAA,KAAK,CAACJ,IAAN,GAAa,IAAb;AACAI,MAAAA,KAAK,CAACH,KAAN,GAAcI,MAAM,CAACC,OAArB;AACD,KARO;AASRE,IAAAA,MAAM,EAAGJ,KAAD,IAAW;AACjBA,MAAAA,KAAK,CAACJ,IAAN,GAAa,IAAb;AACAI,MAAAA,KAAK,CAACH,KAAN,GAAc,IAAd;AACD;AAZO;AANkB,CAAD,CAA7B;AAqBA,OAAO,MAAMQ,cAAc,GAAG,MAAM;AAClC,QAAMC,cAAc,GAAGC,MAAM,CAACC,YAAP,CAAoBC,OAApB,CAA4B,mBAA5B,CAAvB;;AACA,MAAIH,cAAJ,EAAoB;AAClB,UAAMV,IAAI,GAAGc,IAAI,CAACC,KAAL,CAAWL,cAAX,CAAb;AACAhB,IAAAA,YAAY,CAACsB,QAAb,CAAsBhB,IAAI,CAACiB,KAA3B;AACA,WAAOpB,SAAS,CAACqB,OAAV,CAAkBf,YAAlB,CAA+BH,IAA/B,CAAP;AAED;;AACD,SAAOO,YAAY,EAAnB;AACD,CATM;AAUP,OAAO,MAAMY,KAAK,GAAG,CAACC,QAAD,EAAWC,QAAX,KAAwB,MAAMC,QAAN,IAAkB;AAC7D,MAAI;AACF,UAAMtB,IAAI,GAAG,MAAMN,YAAY,CAACyB,KAAb,CAAmB;AAAEC,MAAAA,QAAF;AAAYC,MAAAA;AAAZ,KAAnB,CAAnB;AAEAV,IAAAA,MAAM,CAACC,YAAP,CAAoBW,OAApB,CAA4B,mBAA5B,EAAiDT,IAAI,CAACU,SAAL,CAAexB,IAAf,CAAjD;AACAJ,IAAAA,WAAW,CAACoB,QAAZ,CAAqBhB,IAAI,CAACiB,KAA1B;AACAK,IAAAA,QAAQ,CAACzB,SAAS,CAACqB,OAAV,CAAkBf,YAAlB,CAA+BH,IAA/B,CAAD,CAAR;AACD,GAND,CAME,OAAOyB,SAAP,EAAkB;AAClBH,IAAAA,QAAQ,CAACzB,SAAS,CAACqB,OAAV,CAAkBX,YAAlB,CAA+BkB,SAA/B,CAAD,CAAR;AACD;AACF,CAVM;AAYP,OAAO,MAAM;AAAEtB,EAAAA,YAAF;AAAgBI,EAAAA;AAAhB,IAAiCV,SAAS,CAACqB,OAAjD;AAEP,eAAerB,SAAS,CAAC6B,OAAzB","sourcesContent":["import loginService from '../../services/login'\nimport { createSlice } from '@reduxjs/toolkit'\nimport blogService from '../../services/blogs'\n\nconst authSlice = createSlice({\n  name: 'auth',\n  initialState: {\n    user: null,\n    error: null,\n  },\n  reducers: {\n    loginSuccess: (state, action) => {\n      state.user = action.payload\n      state.error = null\n    },\n    loginFailure: (state, action) => {\n      state.user = null\n      state.error = action.payload\n    },\n    logout: (state) => {\n      state.user = null\n      state.error = null\n    },\n  },\n})\nexport const initializeUser = () => {\n  const loggedUserJson = window.localStorage.getItem('loggedBlogappUser')\n  if (loggedUserJson) {\n    const user = JSON.parse(loggedUserJson)\n    loginService.setToken(user.token)\n    return authSlice.actions.loginSuccess(user)\n\n  }\n  return loginFailure()\n}\nexport const login = (username, password) => async dispatch => {\n  try {\n    const user = await loginService.login({ username, password })\n\n    window.localStorage.setItem('loggedBlogappUser', JSON.stringify(user))\n    blogService.setToken(user.token)\n    dispatch(authSlice.actions.loginSuccess(user))\n  } catch (exception) {\n    dispatch(authSlice.actions.loginFailure(exception))\n  }\n}\n\nexport const { loginSuccess, loginFailure } = authSlice.actions\n\nexport default authSlice.reducer"]},"metadata":{},"sourceType":"module"}