{"ast":null,"code":"import loginService from '../../services/login';\nimport { createSlice } from '@reduxjs/toolkit';\nconst authSlice = createSlice({\n  name: 'auth',\n  initialState: {\n    user: null,\n    error: null\n  },\n  reducers: {\n    loginSuccess: (state, action) => {\n      state.user = action.payload;\n      state.error = null;\n    },\n    loginFailure: (state, action) => {\n      state.user = null;\n      state.error = action.payload;\n    },\n    logout: state => {\n      state.user = null;\n      state.error = null;\n    }\n  }\n});\nexport const initializeUser = () => {\n  const loggedUserJson = window.localStorage.getItem('loggedBlogappUser');\n\n  if (loggedUserJson) {\n    const user = JSON.parse(loggedUserJson);\n    loginService.setToken(user.token);\n    return authSlice.actions.loginSuccess(user);\n  }\n\n  return loginFailure();\n};\nexport const login = (username, password) => async dispatch => {\n  try {\n    const user = await loginService.login({\n      username,\n      password\n    });\n    window.localStorage.setItem('loggedBlogappUser', JSON.stringify(user));\n    loginService.setToken(user.token);\n    dispatch(authSlice.actions.loginSuccess(user));\n  } catch (exception) {\n    dispatch(authSlice.actions.loginFailure(exception));\n  }\n};\nexport const {\n  loginSuccess,\n  loginFailure\n} = authSlice.actions;\nexport default authSlice.reducer;","map":{"version":3,"sources":["/home/ali/Vscodecop/FullstackOpen/blogs/client/src/features/users/authSlice.js"],"names":["loginService","createSlice","authSlice","name","initialState","user","error","reducers","loginSuccess","state","action","payload","loginFailure","logout","initializeUser","loggedUserJson","window","localStorage","getItem","JSON","parse","setToken","token","actions","login","username","password","dispatch","setItem","stringify","exception","reducer"],"mappings":"AAAA,OAAOA,YAAP,MAAyB,sBAAzB;AACA,SAASC,WAAT,QAA4B,kBAA5B;AAEA,MAAMC,SAAS,GAAGD,WAAW,CAAC;AAC5BE,EAAAA,IAAI,EAAC,MADuB;AAE5BC,EAAAA,YAAY,EAAC;AACXC,IAAAA,IAAI,EAAC,IADM;AAEXC,IAAAA,KAAK,EAAC;AAFK,GAFe;AAM5BC,EAAAA,QAAQ,EAAC;AACPC,IAAAA,YAAY,EAAC,CAACC,KAAD,EAAOC,MAAP,KAAkB;AAC7BD,MAAAA,KAAK,CAACJ,IAAN,GAAWK,MAAM,CAACC,OAAlB;AACAF,MAAAA,KAAK,CAACH,KAAN,GAAY,IAAZ;AACD,KAJM;AAKPM,IAAAA,YAAY,EAAC,CAACH,KAAD,EAAOC,MAAP,KAAkB;AAC7BD,MAAAA,KAAK,CAACJ,IAAN,GAAW,IAAX;AACAI,MAAAA,KAAK,CAACH,KAAN,GAAYI,MAAM,CAACC,OAAnB;AACD,KARM;AASPE,IAAAA,MAAM,EAAEJ,KAAD,IAAW;AAChBA,MAAAA,KAAK,CAACJ,IAAN,GAAW,IAAX;AACAI,MAAAA,KAAK,CAACH,KAAN,GAAY,IAAZ;AACD;AAZM;AANmB,CAAD,CAA7B;AAqBA,OAAO,MAAMQ,cAAc,GAAG,MAAM;AAClC,QAAMC,cAAc,GAAGC,MAAM,CAACC,YAAP,CAAoBC,OAApB,CAA4B,mBAA5B,CAAvB;;AACA,MAAGH,cAAH,EAAkB;AAChB,UAAMV,IAAI,GAAGc,IAAI,CAACC,KAAL,CAAWL,cAAX,CAAb;AACAf,IAAAA,YAAY,CAACqB,QAAb,CAAsBhB,IAAI,CAACiB,KAA3B;AACA,WAAOpB,SAAS,CAACqB,OAAV,CAAkBf,YAAlB,CAA+BH,IAA/B,CAAP;AAED;;AACD,SAAOO,YAAY,EAAnB;AACD,CATM;AAUP,OAAO,MAAMY,KAAK,GAAG,CAACC,QAAD,EAAUC,QAAV,KAAuB,MAAMC,QAAN,IAAkB;AAC5D,MAAG;AACD,UAAMtB,IAAI,GAAG,MAAML,YAAY,CAACwB,KAAb,CAAmB;AAACC,MAAAA,QAAD;AAAUC,MAAAA;AAAV,KAAnB,CAAnB;AACAV,IAAAA,MAAM,CAACC,YAAP,CAAoBW,OAApB,CAA4B,mBAA5B,EAAgDT,IAAI,CAACU,SAAL,CAAexB,IAAf,CAAhD;AACAL,IAAAA,YAAY,CAACqB,QAAb,CAAsBhB,IAAI,CAACiB,KAA3B;AACAK,IAAAA,QAAQ,CAACzB,SAAS,CAACqB,OAAV,CAAkBf,YAAlB,CAA+BH,IAA/B,CAAD,CAAR;AACD,GALD,CAKC,OAAMyB,SAAN,EAAgB;AACfH,IAAAA,QAAQ,CAACzB,SAAS,CAACqB,OAAV,CAAkBX,YAAlB,CAA+BkB,SAA/B,CAAD,CAAR;AACD;AACF,CATM;AAWP,OAAO,MAAM;AAAEtB,EAAAA,YAAF;AAAeI,EAAAA;AAAf,IAA8BV,SAAS,CAACqB,OAA9C;AAEP,eAAerB,SAAS,CAAC6B,OAAzB","sourcesContent":["import loginService from '../../services/login'\nimport { createSlice } from '@reduxjs/toolkit'\n\nconst authSlice = createSlice({\n  name:'auth',\n  initialState:{\n    user:null,\n    error:null,\n  },\n  reducers:{\n    loginSuccess:(state,action) => {\n      state.user=action.payload\n      state.error=null\n    },\n    loginFailure:(state,action) => {\n      state.user=null\n      state.error=action.payload\n    },\n    logout:(state) => {\n      state.user=null\n      state.error=null\n    },\n  }\n})\nexport const initializeUser = () => {\n  const loggedUserJson = window.localStorage.getItem('loggedBlogappUser')\n  if(loggedUserJson){\n    const user = JSON.parse(loggedUserJson)\n    loginService.setToken(user.token)\n    return authSlice.actions.loginSuccess(user)\n\n  }\n  return loginFailure()\n}\nexport const login = (username,password) => async dispatch => {\n  try{\n    const user = await loginService.login({username,password})\n    window.localStorage.setItem('loggedBlogappUser',JSON.stringify(user))\n    loginService.setToken(user.token)\n    dispatch(authSlice.actions.loginSuccess(user))\n  }catch(exception){\n    dispatch(authSlice.actions.loginFailure(exception))\n  }\n}\n\nexport const { loginSuccess,loginFailure }=authSlice.actions\n\nexport default authSlice.reducer"]},"metadata":{},"sourceType":"module"}